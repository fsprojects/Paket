<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Paket shell completion for <a href="http://zsh.org/">zsh</a>
</title>
    <link rel="icon" type="image/png" href="./img/logo.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="A dependency manager for .NET with support for NuGet packages and git repositories."/>
    <meta name="author" content="Steffen Forkmann, Alexander GroÃŸ"/>

    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link type="text/css" rel="stylesheet" href="./content/style.css" />
    <script type="text/javascript" src="./content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <style type="text/css">
      table.pre td.lines {
        vertical-align: top;
      }
      pre.fssnip code[lang=batchfile],
      pre.fssnip code[lang=msh] {
        display: inline-block;
        white-space: pre-wrap;       /* CSS 3 */
        white-space: -moz-pre-wrap;  /* Mozilla, since 1999 */
        white-space: -pre-wrap;      /* Opera 4-6 */
        white-space: -o-pre-wrap;    /* Opera 7 */
        word-wrap: break-word;       /* Internet Explorer 5.5+ */
        word-break: keep-all;
        padding-left: 2em;
        text-indent: -2em;
      }
    </style>
    <script type="text/javascript">
      $(function() {
        $("code[lang='batchfile'], code[lang='msh']").each(function() {
          $(this).html($(this).html().replace(/ &lt;/g, "&nbsp;&lt;"))
        })
      })
    </script>
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/fsprojects/Paket">github page</a></li>
        </ul>
        <h3 class="muted"><a href="./index.html">Paket</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Paket-shell-completion-for-zsh" class="anchor" href="#Paket-shell-completion-for-zsh">Paket shell completion for <a href="http://zsh.org/">zsh</a></a></h1>
<h2><a name="Installation" class="anchor" href="#Installation">Installation</a></h2>
<h3><a name="Download" class="anchor" href="#Download">Download</a></h3>
<ol>
<li>
Download the
<a href="https://raw.githubusercontent.com/fsprojects/Paket/master/completion/paket-completion.zsh"><code>paket-completion.zsh</code> file</a>
to a subdirectory of your home directory, preferably a directory with other
function files.
</li>
<li>Rename it to <code>_paket</code>.</li>
<li>Add the directory to your zsh <code>fpath</code> before running <code>compinit</code>.</li>
</ol>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">$ target="$HOME/.zsh-completions"
$ mkdir "$target"
$ curl --fail --location --proto-redir -all,https --output "$target/_paket" \
  https://raw.githubusercontent.com/fsprojects/Paket/master/completion/paket-completion.zsh
</code></pre></td></tr></table>
<p>In your <code>~/.zshrc</code>:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">fpath=($HOME/directory/where/_paket/resides $fpath)
</code></pre></td></tr></table>
<h3><a name="Updating-an-existing-installation" class="anchor" href="#Updating-an-existing-installation">Updating an existing installation</a></h3>
<p>Just repeat the download from above.</p>
<p>Alternatively the completion script comes bundled with the
<code>paket-completion-update</code> function that will download the current
<code>paket-completion.zsh</code> to the same file as above, even if you changed its
location after the initial download.</p>
<p><strong>Please note:</strong> The <code>paket-completion-update</code> function requires <code>curl</code> to be
installed. <code>paket-completion-update</code> is <em>only available after your
first <code>paket</code> completion</em> per shell session (i.e. after the Paket completion
functions have been <code>autoload</code>ed by zsh).</p>
<p><code>paket-completion-update</code> supports an optional first parameter that allows you
to override the default download root URL which is
<code>https://raw.githubusercontent.com/fsprojects/Paket/master/completion</code>.</p>
<h3><a name="alias" class="anchor" href="#alias"><code>paket</code> alias</a></h3>
<p>For easier consumption of Paket (without <code>paket.sh</code> or <code>paket.cmd</code>) it is
advised to create an alias and always run Paket from the repository root.</p>
<p>Also have a look at
<a href="https://fsprojects.github.io/Paket/bootstrapper.html#Magic-mode">Paket's magic mode</a>.</p>
<p>Somewhere in your <code>~/.zshrc</code>:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">if [[ "$OS" != Windows* ]]; then
  alias paket='mono ./.paket/paket.exe'
else
  alias paket='./.paket/paket.exe'
fi
</code></pre></td></tr></table>
<p>Also ensure that zsh
<a href="http://zsh.sourceforge.net/Doc/Release/Options.html#index-COMPLETEALIASES">completes aliases based on the expanded alias contents</a>.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">unsetopt completealiases
</code></pre></td></tr></table>
<p>If you don't like alias completion, define that the <code>paket</code> alias should be
completed using the <code>_paket</code> function defined in the <code>_paket</code> file.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">setopt completealiases
compdef _paket paket
</code></pre></td></tr></table>
<h3><a name="Mono" class="anchor" href="#Mono">Mono</a></h3>
<p>If you use Mono (e.g. on Linux or macOS) and do not have Mono completion
installed, you need to define that <code>mono</code> invokes other programs:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">compdef _precommand mono
</code></pre></td></tr></table>
<p>This is similar to <a href="http://man7.org/linux/man-pages/man1/nohup.1p.html"><code>nohup</code></a>
invoking the "real" program that needs to be completed.
<a href="https://unix.stackexchange.com/a/178054/72946">More details.</a></p>
<p>For an exemplar <code>mono</code> completion, have a look at
<a href="https://github.com/agross/dotfiles/tree/master/mono/functions/_mono">@agross dotfiles</a>.</p>
<h2><a name="Configuration" class="anchor" href="#Configuration">Configuration</a></h2>
<p>You can configure some aspects of Paket completion. Add these to your
<code>~/.zshrc</code>.</p>
<h3><a name="Define-where-to-look-for" class="anchor" href="#Define-where-to-look-for">Define where to look for <code>paket.exe</code></a></h3>
<p>Depending on what should be completed the Paket executable will be run by the
completion script. The completion script searches for a local installation at
<code>./.paket/paket.exe</code> first. Local installs will be prepended with <code>mono</code> unless
you are running Windows. Global installations will be looked at last (i.e.
<code>paket</code> in the <code>$PATH</code>). They are not prepended with <code>mono</code>.</p>
<p>To override the list of possible locations for local installations of
<code>paket.exe</code>, define the following <code>paket-executable</code> style. The list of values
will be searched as defined.</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh"># This is the default.
zstyle ':completion::complete:paket:*' paket-executable './.paket/paket.exe'
# Useful for Paket developers: Prefer the locally built version in bin over the one in .paket.
zstyle ':completion::complete:paket:*' paket-executable './bin/paket.exe' './.paket/paket.exe'
</code></pre></td></tr></table>
<h3><a name="Enable-infix-matching-for-package-IDs" class="anchor" href="#Enable-infix-matching-for-package-IDs">Enable infix matching for package IDs</a></h3>
<p>By default <code>paket find-packages</code> will match infixes, which is not the default
mode for Paket completion. I think it's unnatural to type</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">paket add FAK&lt;tab&gt;
</code></pre></td></tr></table>
<p>which will be completed to</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">paket add Altairis.Fakturoid.Client
</code></pre></td></tr></table>
<p>if infix matching is enabled.</p>
<p>If you want this behavior, enable infix matches:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' infix-match yes
zstyle ':completion::complete:paket:add:*' infix-match yes # Only for paket add.
</code></pre></td></tr></table>
<h3><a name="Disable-fallback-i-e-default-zsh-completion-for-Paket-commands-that-do-not-have-a-completion-function" class="anchor" href="#Disable-fallback-i-e-default-zsh-completion-for-Paket-commands-that-do-not-have-a-completion-function">Disable fallback (i.e. default zsh) completion for Paket commands that do not have a completion function</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' use-fallback no
</code></pre></td></tr></table>
<h3><a name="Disable-verbose-completion-of-main-commands" class="anchor" href="#Disable-verbose-completion-of-main-commands">Disable verbose completion of main commands</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' verbose no
</code></pre></td></tr></table>
<h3><a name="Define-the-zsh-completion-cache-policy-for-expensive-operations-that-generate-completions" class="anchor" href="#Define-the-zsh-completion-cache-policy-for-expensive-operations-that-generate-completions">Define the zsh completion cache policy for expensive operations that generate completions</a></h3>
<p>Paket will e.g. issue HTTP requests when you complete a package ID or a
version number. These take time so we take advantage of the zsh
completion cache and store such results.</p>
<p>Enable the zsh completion cache globally, including completions for other
commands that also leverage caching:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path instead/of/$HOME/.zcompcache # Optional.
</code></pre></td></tr></table>
<p>To disable the cache for specific Paket commands to always get fresh
results when completing e.g. <code>paket add</code>:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:add:*' use-cache off
</code></pre></td></tr></table>
<p>The caches are stored under the <code>cache-path</code> as follows:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="text">&lt;cache-path&gt;/paket/&lt;expensive command&gt;/&lt;parameter&gt;
</code></pre></td></tr></table>
<p>e.g. <code>&lt;cache-path&gt;/paket/find-packages/fak</code> if you completed <code>paket add FAK</code> or
<code>paket add fak</code> before.</p>
<p>The default cache policy caches results for 1 day (see <code>_paket_cache_policy</code>).
To remove cached results you can either delete the
<code>&lt;cache-path&gt;/paket</code> directory or provide a custom cache policy to control
cache expiration for all or specific Paket commands:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l"> 1: </span>
<span class="l"> 2: </span>
<span class="l"> 3: </span>
<span class="l"> 4: </span>
<span class="l"> 5: </span>
<span class="l"> 6: </span>
<span class="l"> 7: </span>
<span class="l"> 8: </span>
<span class="l"> 9: </span>
<span class="l">10: </span>
<span class="l">11: </span>
<span class="l">12: </span>
<span class="l">13: </span>
<span class="l">14: </span>
<span class="l">15: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' cache-policy _default_cache_policy
zstyle ':completion::complete:paket:find-packages:*' cache-policy _strict_cache_policy

_default_cache_policy () {
  # Rebuild if the cache is more than a week old.
  local cache="$1"
  local -a outdated
  # See http://zsh.sourceforge.net/Doc/Release/Expansion.html#Glob-Qualifiers
  outdated=( "$cache"(Nm+7) )
  (( $#outdated ))
}

_strict_cache_policy () {
  return 0 # 0 == always outdated, you should better use use-cache off.
}
</code></pre></td></tr></table>
<p>There are two special default cache policies for completions relying on the
existence of local files, e.g. <code>paket.dependencies</code> and <code>paket.lock</code>.
For Paket commands that read these, the cache is invalidated as soon as the
file's modification time is newer than the cache.
(See <code>_paket_cache_policy_dependencies_file</code> and
<code>_paket_cache_policy_lock_file</code>.)</p>
<h3><a name="Disable-running-Paket-to-get-packages-versions-etc-as-completion-arguments" class="anchor" href="#Disable-running-Paket-to-get-packages-versions-etc-as-completion-arguments">Disable running Paket to get packages, versions etc. as completion arguments</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' disable-completion yes
</code></pre></td></tr></table>
<p>Disable only a single means to get completion values:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
<span class="l">6: </span>
<span class="l">7: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh"># Used by e.g. paket add:
zstyle ':completion::complete:paket:find-packages:' disable-completion yes
zstyle ':completion::complete:paket:find-package-versions:' disable-completion yes
zstyle ':completion::complete:paket:show-groups:' disable-completion yes

# Used by e.g. paket why:
zstyle ':completion::complete:paket:show-installed-packages:' disable-completion yes
</code></pre></td></tr></table>
<h3><a name="Custom-feed-URLs-for-and-argument" class="anchor" href="#Custom-feed-URLs-for-and-argument">Custom feed URLs for <code>--source</code> and <code>paket push --url</code> argument</a></h3>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:*' sources 'http://one.example.com/feed/v2'
zstyle ':completion::complete:paket:*' sources \
  'http://one.example.com/feed/v2' \
  'http://second.example.com/feed/v2'
</code></pre></td></tr></table>
<p>Override list for a specific command:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
</pre></td>
<td class="snippet"><pre class="fssnip"><code lang="sh">zstyle ':completion::complete:paket:find-package-versions:*' sources \
  'http://another.example.com/feed/v2'
zstyle ':completion::complete:paket:push:*' sources \
  'https://myget.org/F/my-feed-name'
</code></pre></td></tr></table>


        </div>
        <div class="span3">
          <img src="./img/logo.png" alt="F# Project" style="width:150px;margin:10px" />
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">Paket</li>
            <li><a href="./index.html">Home page</a></li>
            <li><a href="./getting-started.html">Getting started</a></li>
            <li><a href="./convert-from-nuget-tutorial.html">Convert from NuGet</a></li>
            <li><a href="./faq.html">FAQ</a></li>
            <li><a href="./glossary.html">Glossary</a></li>
            <li><a href="./release-notes.html">Release Notes</a></li>
            <li><a href="./testimonials.html">Testimonials</a></li>
            <li><a href="./license.html">License</a></li>

            <li class="nav-header">Download Paket</li>
            <li><a href="http://nuget.org/packages/Paket" target="_blank">From NuGet</a></li>
            <li><a href="https://github.com/fsprojects/Paket/releases/latest" target="_blank">From GitHub</a></li>

            <li class="nav-header">GitHub</li>
            <li><a href="http://github.com/fsprojects/Paket" target="_blank">Source Code on GitHub</a></li>
            <li><a href="http://github.com/fsprojects/Paket/issues" target="_blank">Report an issue</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="./dependencies-file.html">paket.dependencies</a></li>
            <li><a href="./lock-file.html">paket.lock</a></li>
            <li><a href="./references-files.html">paket.references</a></li>
            <li><a href="./template-files.html">paket.template</a></li>
            <li><a href="./local-file.html">paket.local</a></li>
            <li><a href="./paket-folder.html">.paket folder</a></li>
            <li><a href="./bootstrapper.html">paket.bootstrapper.exe</a></li>
            <li class="divider"></li>
            <li><a href="./resolver.html">Package resolution algorithm</a></li>
            <li><a href="./groups.html">Dependency Groups</a></li>
            <li><a href="./caches.html">Additional Caches</a></li>
            <li><a href="./nuget-dependencies.html">NuGet dependencies</a></li>
            <li><a href="./git-dependencies.html">Git dependencies</a></li>
            <li><a href="./github-dependencies.html">GitHub dependencies</a></li>
            <li><a href="./http-dependencies.html">HTTP dependencies</a></li>
            <li><a href="./analyzers.html">Analyzers</a></li>
            <li class="divider"></li>
            <li><a href="./installation.html">Installation</a></li>
            <li><a href="./paket-and-dotnet-cli.html">Using Paket with dotnet cli</a></li>
            <li><a href="./reference-from-repl.html">Using Paket from F# Interactive</a></li>
            <li><a href="./editor-support.html">Editor support</a></li>
            <li><a href="./shell-completion.html">Shell completion</a></li>
            <li class="divider"></li>
            <li><a href="./reference/index.html">API Reference</a></li>

            <li class="nav-header">Paket commands</li>
            <li><a href="./paket-add.html">paket add</a></li>
            <li><a href="./paket-auto-restore.html">paket auto-restore</a></li>
            <li><a href="./paket-clear-cache.html">paket clear-cache</a></li>
            <li><a href="./paket-config.html">paket config</a></li>
            <li><a href="./paket-convert-from-nuget.html">paket convert-from-nuget</a></li>
            <li><a href="./paket-find-refs.html">paket find-refs</a></li>
            <li><a href="./paket-find-packages.html">paket find-packages</a></li>
            <li><a href="./paket-find-package-versions.html">paket find-package-versions</a></li>
            <li><a href="./paket-generate-load-scripts.html">paket generate-load-scripts</a></li>
            <li><a href="./paket-init.html">paket init</a></li>
            <li><a href="./paket-install.html">paket install</a></li>
            <li><a href="./paket-outdated.html">paket outdated</a></li>
            <li><a href="./paket-pack.html">paket pack</a></li>
            <li><a href="./paket-push.html">paket push</a></li>
            <li><a href="./paket-remove.html">paket remove</a></li>
            <li><a href="./paket-restore.html">paket restore</a></li>
            <li><a href="./paket-simplify.html">paket simplify</a></li>
            <li><a href="./paket-show-groups.html">paket show-groups</a></li>
            <li><a href="./paket-show-installed-packages.html">paket show-installed-packages</a></li>
            <li><a href="./paket-update.html">paket update</a></li>
            <li><a href="./paket-why.html">paket why</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/fsprojects/Paket"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
</html>
